<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data noupdate="1">

        <!-- Mail Template -->
        <record id="mail_template_task_limit_reminder" model="mail.template">
            <field name="name">Alert Thresold Limit on Task</field>
            <field name="email_from">${(object.company_id.email and '%s &lt;%s&gt;' % (object.company_id.name, object.company_id.email) or '')|safe}</field>
            <field name="subject">${object.company_id.name} Thresold Limit Exceeded on #${str(object.id) + " " + object.name}</field>
            <field name="partner_to">${object.user_id.partner_id.id}</field>
            <field name="model_id" ref="project.model_project_task" />
            <field name="auto_delete" eval="True" />
            <field name="lang">${object.user_id.partner_id.lang or 'es_ES'}</field>
            <field name="body_html"><![CDATA[
% set access_url = object.get_task_url() or ''
<p>Dear ${object.user_id.name},</p>

<br/>

<p>The task <a href="${access_url}">#${str(object.id) + " " + object.name}</a> with the progress ${object.progress}% has exceeded the configured limit threshold. </p>

<br/>

<p>This email has been generated automatically, please do not replay.</p>
<p>Thank you,</p>
]]></field>
        </record>

        <!-- Ir Cron -->
        <record id="cron_task_limit_reminder" model="ir.cron">
            <field name="name">Project Task - Thresold Reminder</field>
            <field name="model_id" ref="project.model_project_task"/>
            <field name="state">code</field>
            <field name="code">
model._cron_send_reminder_for_task(95)
            </field>
            <field name="active" eval="True"/>
            <field name="user_id" ref="base.user_root"/>
            <field name="interval_number">1</field>
            <field name="interval_type">days</field>
            <field name="numbercall">-1</field>
            <field name="doall" eval="False" />
        </record>

    </data>
</odoo>
